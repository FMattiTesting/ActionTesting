\documentclass[12pt]{article}

\usepackage{stylesheet}

% to speed up compilation speed a bit while drafting
\pdfcompresslevel=0
\pdfobjcompresslevel=0

\title{Randomized trace estimation for parameter-dependent matrices applied to spectral density approximation}

\begin{document}

\maketitle

%\todo{
%\begin{itemize}
%    \item Unify index notation
%    \item Double-check proofs
%    \item Add all references
%    \item Run numerical experiments 
%    \item Write introduction, abstract, and discussion
%    \item ArXiv HTML support (check if packages)
%\end{itemize}
%}

%\todo{
%    \tableofcontents
%}

\begin{abstract}
    Stochastic trace estimators are a family of well established techniques for approximating the trace of constant matrices. Oftentimes the matrix whose trace we aim to approximate continuously depends on a real parameter $t \in [a,b]$. This is for example the case when approximating the spectral density of a matrix or computing partition functions of quantum systems. Clearly, we could separately approximate the traces of the constant matrices $\mtx{B}(t_1), \dots, \mtx{B}(t_m)$ at the fixed values $t_1, \dots, t_m \in [a, b]$. However, this approach does not scale well if $m$ is large. We analyze three trace estimators for constant matrices -- the Girard-Hutchinson, Nyström, and Nyström++ estimators -- when they are applied to parameter-dependent matrices with the same randomization reused for all values of the parameter $t$. We show that all of these estimators closely match their corresponding error guarantees for constant matrices. In particular, for the Nyström++ method, we can guarantee an error of at most $\varepsilon$ by computing the estimate with just $\mathcal{O}(\varepsilon^{-1})$ random vectors, independent of what structure the symmetric positive semi-definite matrix $\mtx{B}(t)$ has. We employ these trace estimators to improve upon a technique for approximating the spectral density of a matrix and provide a detailed analysis of the resulting method. Finally, we confirm our theoretical developments in multiple numerical experiments.
\end{abstract}

\textcolor{red}{TODO for Fabio:
\begin{itemize}
 \item The text style is a bit too generous but no need to change this now. \textcolor{green}{Ok! Let's talk about it at some point.}
\end{itemize}
}
\color{blue}
\input{intro.tex}
\input{analysis.tex}
\input{spectraldensity.tex}
\input{numresults.tex}




%\section{Conclusion}
%\label{sec:conclusion}
%
%\todo{
%\begin{itemize}
%    \item Robustness (can choose $m$ and $n_{\mtx{\Omega}}$, $n_{\mtx{\Psi}}$ as large as one wants, and not break algorithm, unlike Krylov-aware Lanczos)
%\end{itemize}
%}
\paragraph{Acknowledgements.} The authors gratefully acknowledge the help of Lin Lin in reproducing the example in \refsec{subsec:hamiltonian}. They thank David Persson for many enlightening discussions relating the proof in \refsec{subsec:nystrom-pp}.

\printbibliography

\input{appendix.tex}

\end{document}
